{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
  <h2 class="mb-4">ðŸ“Š Dashboard Wayne Enterprises</h2>

  <!-- Cards Resumo -->
  <div class="row g-3">
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm border-0 bg-primary text-white text-center h-100">
        <div class="card-body">
          <h5 class="card-title">ðŸ‘¥ UsuÃ¡rios</h5>
          <p class="display-5 fw-bold">{{ total_usuarios }}</p>
          <small>Total cadastrado</small>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm border-0 bg-success text-white text-center h-100">
        <div class="card-body">
          <h5 class="card-title">ðŸ“¦ Recursos</h5>
          <p class="display-5 fw-bold">{{ total_recursos }}</p>
          <small>Total cadastrado</small>
        </div>
      </div>
    </div>
  </div>

  <!-- GrÃ¡ficos -->
  <div class="row mt-4">
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title"> Recursos por Tipo</h5>
          <canvas id="barChart"></canvas>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title"> DistribuiÃ§Ã£o de Recursos</h5>
          <canvas id="pieChart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Ãšltimos registros -->
  <div class="row mt-4">
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title"> Ãšltimos UsuÃ¡rios</h5>
          <ul class="list-group list-group-flush">
            {% for usuario in ultimos_usuarios %}
              <li class="list-group-item">
                <strong>{{ usuario.username }}</strong> â€” {{ usuario.role }}
              </li>
            {% empty %}
              <li class="list-group-item text-muted">Nenhum usuÃ¡rio cadastrado ainda.</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title"> Ãšltimos Recursos</h5>
          <ul class="list-group list-group-flush">
            {% for recurso in ultimos_recursos %}
              <li class="list-group-item">
                <strong>{{ recurso.nome }}</strong> â€” {{ recurso.tipo }}
              </li>
            {% empty %}
              <li class="list-group-item text-muted">Nenhum recurso cadastrado ainda.</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // GrÃ¡fico de barras
  new Chart(document.getElementById("barChart"), {
    type: "bar",
    data: {
      labels: {{ tipos|safe }},
      datasets: [{
        label: "Quantidade",
        data: {{ quantidades|safe }},
        backgroundColor: ['#0d6efd','#198754','#dc3545','#ffc107','#6610f2']
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } } }
  });

  // GrÃ¡fico de pizza
  new Chart(document.getElementById("pieChart"), {
    type: "pie",
    data: {
      labels: {{ tipos|safe }},
      datasets: [{
        data: {{ quantidades|safe }},
        backgroundColor: ['#0d6efd','#198754','#dc3545','#ffc107','#6610f2']
      }]
    },
    options: { responsive: true }
  });
</script>
{% endblock %}
